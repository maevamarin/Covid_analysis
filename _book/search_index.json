[
["index.html", "Homework 3 : the spread of COVID-19 1 Basic instructions", " Homework 3 : the spread of COVID-19 Mathieu Eugénie, Marin Maeva 26 avril, 2020 1 Basic instructions To obtain the maximum number of points, use whenever possible: the pipeline symbol %&gt;%, dplyr verbs, kable to print tables, ggplot to produce the figures, purrr’s functions to minimize code duplication, broom’s functions to format the results model fits. Also: Pay attention to the general aesthetics of your report (i.e., formatting of the tables, sizing of the figures, etc.). Use inline code to display single numbers, and echo = FALSE for code chunks when you display a table of produce a figure (i.e., we don’t want to see code unless it is necessary). Minimize the amount of code duplication by using iterations concepts and list-columns. Comment your code to explain what you are doing. "],
["introduction.html", "2 Introduction 2.1 The data 2.2 A note on Epidemiological Models 2.3 This assigment", " 2 Introduction 2.1 The data For this assignment, we use COVID-19 data provided by Johns Hopkins University (updated daily), as well as data from the world bank with demographic information. More specifically, we use daily records of total confirmed infection cases (or cumulative number of cases), total number of fatalities (or cumulative number of deaths) per country starting from 2020-01-22 until 2020-04-05. The dataset, downloaded on 2020-04-06, contains 12,975 observations and 13 variables (country, iso3c, date, confirmed, deaths, population, land_area_skm, pop_density, pop_largest_city, gdp_capita, life_expectancy, region, income). 2.2 A note on Epidemiological Models Today’s epidemiological models are mostly described by so called SIR-like models (see details in Martcheva 2015, 9–12). In this class of models, the population is divided into three groups: (S)usceptible — people, might get infected; (I)nfectious — people, who carry the infection and can infect others; (R)ecovered/(R)emoved — people, who have already recovered from the disease and got immunity. The SIR model is a system of ordinary nonlinear differential equations. In this homework, we focus on the following logistic model (see Batista 2020, 2; Martcheva 2015, 35–36): \\[ \\frac{dC(t)}{dt} = r \\, C(t) \\cdot \\left[1 - \\frac{C(t)}{K}\\right], \\] where \\(C(t)\\) is the accumulated number of cases at time \\(t\\), \\(r\\) is the growth rate (or infection rate), and \\(K\\) is the final size of epidemic. Let \\(C_0\\) be the initial number of cases: in other words, at time \\(t = 0\\), assume that there was \\(C_0\\) accumulated number of cases. The solution of the logistic model is \\[ C(t) = \\frac{K\\cdot C_0}{C_0 + (K-C_0) \\, \\exp(-r\\,t)}, \\] which looks like a scaled logit model in econometrics. 2.3 This assigment Because we only have access to the confirmed cases that are reported, we use those figures as a proxy for the total number of cases, with the understanding that they almost surely underestimates the actual number of interest. In what follows, we do a preliminary exploration of the data. We then use the logistic model to analyze the spread of COVID-19 and try to predict the final number of accumulated confirmed cases for every country. More specifically, we start by focusing on modelling the spread in Switzerland; then apply the same approach to every country in the dataset. References "],
["exploratory-data-analysis.html", "3 Exploratory data analysis 3.1 Description of the state of the spread 3.2 Data selection and alignment", " 3 Exploratory data analysis 3.1 Description of the state of the spread Provide a high level description of the state of the spread. In particular, include the number of days that have passed since the first confirmed case/death, the current stage for confirmed cases/deaths/mortality (i.e., ratio of deaths to confirmed cases). You can: use either words, or tables, or figures, or a bit of each, group your analysis per country, or region, or a bit of each. Worldwide analyze Figure 3.1: Worldwide representation Figure 3.2: Deaths against confirmed Figure 3.3: Regarding the region Figure 3.4: Regarding the region Figure 3.5: Deaths against confrimed Figure 3.6: Regarding the population Figure 3.7: Regarding the population Produce a worlwide map of the COVID-19 spread at the latest date available in covid19_data for each country, and describe what you see. Hint: ggplot2 package includes two helpful command for this part, namely map_data() to retrieve a map, and geom_map() to draw a map on a plot. Use expand_limits to make sure you display the whole map of the world. Figure 3.8: Worldmap 3.2 Data selection and alignment To compare the speed of the infection spread between countries, we need to “align” the data. In other words, we model the epidemic using equivalent “starting conditions” for every country. To do that, we filter the data so that the number of confirmed cases (in any country) is greater or equal to the maximal number of confirmed cases at the first day of a specific country. Let \\(C_{d, i}\\) be the number of accumulated confirmed cases on day \\(d\\) for country \\(i\\). Let country \\(k\\) be the one such that it had the highest number of reported cases on the first day in the dataset, that is \\(C_{1, k} \\geq C_{1, i}\\) for any other \\(i\\). Find \\(k\\) and discuss. From covid19_data, extract a new table covid19_data_filtered: Select only the countries \\(i\\), which on some day \\(d_{0,i}\\) have \\(C_{d_{0,i}, i} \\geq C_{0, k}\\). We will call this time \\(d_{0,i}\\) a day-zero for country \\(i\\). In the next sections, we model \\(C_i(t) = C_{d_{0,i} + t,i}\\), that is the spread of the epidemic in country \\(i\\) with \\(t\\) representing “event days”. Remember, for every country the day-zero is, in general, different. However, when a country entered the epidemic stage, we are only interested in number of days that has passed from the date of entry (i.e. day-zero). Remove countries who are left with less than two weeks of data, i.e. we keep those countries whose number of days that has passed from the day-zero of this country is 14 or more. Create a new column called t representing the number of days from the day-zero of this country. Create a new column called confirmed_1e5pop representing the number of confirmed cases per 100,000 habitants. This is useful in order to compare how the spread of the epidemic differs between countries relative to their population. Discuss using either tables or visualizations or both: Which countries are left in covid19_data_filtered? What is the state of the spread there? What is the relationship between t and confirmed_1e5pop? (#tab:table 1)List of the first countries touched by the pandemic. country date confirmed deaths China 2020-01-22 548 17 Japan 2020-01-22 2 0 Thailand 2020-01-22 2 0 Korea, South 2020-01-22 1 0 USA 2020-01-22 1 0 Afghanistan 2020-01-22 0 0 #&gt; [1] &quot; The $k$ country is China, with 548 confirmed cases ar the earliest data in the data set. In order to do comparisons, we should create a subset where the countries&#39; day 1 starts when the number of confirmed cases reached 548.&quot; Table 3.1: Glimpse of the countries’ day 1 aligned country date confirmed deaths population Australia 2020-03-18 568 6 2.5e+07 Australia 2020-03-19 681 6 2.5e+07 Australia 2020-03-20 791 7 2.5e+07 Australia 2020-03-21 1071 7 2.5e+07 Australia 2020-03-22 1549 7 2.5e+07 Australia 2020-03-23 1682 7 2.5e+07 3.1 Figure 3.9: Country with more thab 50000 confrimed case Figure 3.10: Country with more than 50000 confirmed case &quot; Many countries do not appear on the subset covid_data_filtered because of the threshold of 548 confirmed cases. The measures taken to prevent the covid-19 worldwide have been shared and are common among countries. This preventive measures would have been braked the spread of the virus, making more difficult to reach our threshold of 548. Furthermore, the difference in mean and in protocoles to confirm a case of coronavirus greatly varies among countries in the world. This second barrier is perhaps the greatest to overcome because of the global shortage of testing material. The reported confirmed cases might hide an unknown number of non-tested but positive case to coronavirus (Omitten/hidden cases are like false negative). The countries removed of our panel due to our filtering are 39: Algeria, Argentina, Armenia, Azerbaijan, Bahrain, Belarus, Bosnia and Herzegovina, Cameroon, Colombia, Croatia, Dominican Republic, Egypt, Estonia, Hungary, India, Indonesia, Iraq, Kazakhstan, Kuwait, Lithuania, Mexico, Moldova, Morocco, New Zealand, North Macedonia, Panama, Peru, Philippines, Qatar, Romania, Russia, Saudi Arabia, Serbia, Singapore, Slovenia, South Africa, Tunisia, Ukraine, United Arab Emirates. The countries included in the filtered data are 28 : Australia, Austria, Belgium, Brazil, Canada, China, Czechia, Denmark, France, Germany, Iran, Ireland, Israel, Italy, Japan, South Korea, Luxembourg, Malaysia, Netherlands, Norway, Pakistan, Portugal, Spain, Sweden, Switzerland, Turkey, United Kingdom, USA &quot; "],
["modeling-the-spread-of-covid-19-in-a-single-country.html", "4 Modeling the spread of COVID-19 in a single country 4.1 The logistic model in R 4.2 The logistic model applied to data from Switzerland", " 4 Modeling the spread of COVID-19 in a single country 4.1 The logistic model in R Using the filtered dataset, we study the spread of COVID-19 with the logistic model. Letting \\(C_{i}(t) = C_{d_{0,i} + t,i}\\), the model for country \\(i\\) can be expressed as: \\[ C_{i}(t) = \\frac{K_{i} \\cdot C_{i}(0)}{C_{i}(0) + (K_{i}-C_{i}(0)) \\, \\exp(-R_{i}\\,t)} \\] The goal is to find the final number of cases \\(K_{i}\\) and the infection rate \\(R_{i}\\). We implement this in R using the following function: # here, we assume that data is a data frame with two variables # - t: the number of event days # - confirmed: the number of confirmed cases at time t logistic_model &lt;- function(data) { data &lt;- data %&gt;% arrange(t) C_0 &lt;- data$confirmed[1] C_max &lt;- data$confirmed[nrow(data)] nls( formula = confirmed ~ K / (1 + ((K - C_0) / C_0) * exp(-R * t)), data = data, start = list(K = 2 * C_max, R = 0.5), control = nls.control(minFactor = 1e-6, maxiter = 100) ) } Notice: We use the nonlinear least square method stats::nls to fit the unknown parameters. In R, the formula above is confirmed ~ K / (1 + ((K - C_0)/C_0) * exp(-R * t)). As starting point \\((K_0, R_0)\\) for the optimiser, we set \\(R_0 = 0.5\\) and \\(K_0 = 2 \\, C(t^*)\\), where \\(t^*\\) is the latest information about accumulated confirmed cases. We further set the control argument as nls.control(minFactor = 1e-6, maxiter = 100). 4.2 The logistic model applied to data from Switzerland From covid19_data_filtered, extract a table covid19_ch which corresponds to data for Switzerland. Then: Use the function above to fit the logistic model for Switzerland Describe its output (fitted parameters, broom::tidy() might be useful here) Discuss the goodness-of-fit. Plot the fitted curve, as well as observed data points. Present the predictions of the model. What is the estimated final size of the epidemic and infection rate in Switzerland? 4.1,The prediction shows that the final size of the confirmed case is about 21’500 cases, with an infection rate of 0.246%. Table 4.1: K = confirmed case, R = Infesction rate term estimate std.error statistic p.value K 2.15e+04 373.286 57.7 0 R 2.46e-01 0.003 77.9 0 #&gt; # A tibble: 26 x 5 #&gt; t confirmed C_0 .fitted .resid #&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 0 652 652 652 0 #&gt; 2 1 652 652 827. -175. #&gt; 3 2 1139 652 1046. 92.8 #&gt; 4 3 1359 652 1320. 39.0 #&gt; 5 4 2200 652 1660. 540. #&gt; 6 5 2200 652 2078. 122. #&gt; 7 6 2700 652 2588. 112. #&gt; 8 7 3028 652 3202. -174. #&gt; 9 8 4075 652 3932. 143. #&gt; 10 9 5294 652 4785. 509. #&gt; # ... with 16 more rows Table 4.2: Presentation of the prediction t confirmed C_0 .fitted .resid 0 652 652 652 0.0 1 652 652 827 -174.8 2 1139 652 1046 92.8 3 1359 652 1320 39.0 4 2200 652 1660 540.3 5 2200 652 2078 122.1 6 2700 652 2588 112.3 7 3028 652 3202 -174.0 8 4075 652 3932 143.2 9 5294 652 4785 509.3 10 6575 652 5762 813.0 11 7474 652 6857 616.8 12 8795 652 8054 740.6 13 9877 652 9328 549.2 14 10897 652 10644 253.3 15 11811 652 11963 -152.3 16 12928 652 13248 -319.7 17 14076 652 14462 -385.9 18 14829 652 15578 -749.3 19 15922 652 16579 -657.0 20 16605 652 17456 -850.9 21 17768 652 18209 -441.1 22 18827 652 18845 -17.8 23 19606 652 19374 232.2 24 20505 652 19809 696.5 25 21100 652 20162 937.7 4.2, Presentation of the prediction In this following plot 4.1, we observe the fitted curve, as well as observed data points Figure 4.1: Figure 12 The 2 curves are close, which mean that our predictions are well estimate, regarding are true value. In order to well assess our model, we pot the residuals of the mode. #&gt; Nonlinear regression model #&gt; model: confirmed ~ K/(1 + ((K - C_0)/C_0) * exp(-R * t)) #&gt; data: data #&gt; K R #&gt; 2.15e+04 2.46e-01 #&gt; residual sum-of-squares: 6230581 #&gt; #&gt; Number of iterations to convergence: 7 #&gt; Achieved convergence tolerance: 4.23e-06 Figure 4.2: Figure 13 We observe a pretty well prediction when our fitted value are small, but when they increase, our residuals increase too. 4.2 "],
["modeling-the-spread-of-covid-19-worldwide.html", "5 Modeling the spread of COVID-19 worldwide 5.1 Fitting the logistic model to every country 5.2 Fitted parameters and long-term predictions", " 5 Modeling the spread of COVID-19 worldwide In this section, we fit the logistic model to every country in the covid19_data_filtered dataset. 5.1 Fitting the logistic model to every country Use nested data, list-columns and logistic_model to fit the logistic model to every country in the dataset. Because, for some countries, the optimization method might not converge, you can use possibly() or something similar. For which country does the optimization fail ? Assess the goodness-of-fit of the logistic model in the various countries. Table 5.1: List of the K and R for each country of our model country term estimate std.error Australia K 6.14e+03 6.03e+01 Australia R 2.62e-01 3.00e-03 Austria K 1.30e+04 1.02e+02 Austria R 2.50e-01 2.00e-03 Belgium K 2.74e+04 7.93e+02 Belgium R 2.08e-01 2.00e-03 Brazil K 1.98e+04 2.15e+03 Brazil R 2.17e-01 6.00e-03 Canada K 2.25e+04 1.24e+03 Canada R 2.33e-01 4.00e-03 Chile K 6.48e+03 2.01e+02 Chile R 2.14e-01 3.00e-03 China K 8.07e+04 4.16e+02 China R 2.77e-01 3.00e-03 Czechia K 6.15e+03 1.98e+02 Czechia R 1.85e-01 4.00e-03 Denmark K 3.81e+04 1.76e+04 Denmark R 8.80e-02 2.00e-03 Ecuador K 6.63e+03 1.10e+03 Ecuador R 1.62e-01 1.10e-02 Finland K 2.82e+03 3.39e+02 Finland R 1.39e-01 1.20e-02 France K 1.46e+05 1.45e+04 France R 1.95e-01 3.00e-03 Germany K 1.11e+05 1.98e+03 Germany R 2.34e-01 2.00e-03 Greece K 2.85e+03 1.64e+02 Greece R 1.25e-01 5.00e-03 Iceland K 2.18e+03 1.22e+02 Iceland R 1.29e-01 6.00e-03 Iran K 6.24e+04 3.29e+03 Iran R 1.83e-01 4.00e-03 Ireland K 7.06e+03 2.63e+02 Ireland R 1.92e-01 3.00e-03 Israel K 9.89e+03 3.38e+02 Israel R 2.80e-01 6.00e-03 Italy K 1.30e+05 1.81e+03 Italy R 2.11e-01 1.00e-03 Korea, South K 9.15e+03 1.11e+02 Korea, South R 2.94e-01 9.00e-03 Luxembourg K 3.14e+03 7.95e+01 Luxembourg R 2.21e-01 7.00e-03 Malaysia K 4.36e+03 1.09e+02 Malaysia R 1.69e-01 3.00e-03 Netherlands K 2.23e+04 2.78e+02 Netherlands R 2.00e-01 1.00e-03 Norway K 6.85e+03 1.30e+02 Norway R 1.57e-01 2.00e-03 Pakistan K 4.74e+04 5.54e+04 Pakistan R 1.01e-01 4.00e-03 Poland K 8.77e+03 7.52e+02 Poland R 1.71e-01 4.00e-03 Portugal K 1.39e+04 2.18e+02 Portugal R 2.48e-01 2.00e-03 Spain K 1.38e+05 2.81e+03 Spain R 2.74e-01 3.00e-03 Sweden K 1.85e+04 2.11e+03 Sweden R 1.20e-01 2.00e-03 Switzerland K 2.15e+04 3.73e+02 Switzerland R 2.46e-01 3.00e-03 Thailand K 2.68e+03 4.88e+01 Thailand R 1.91e-01 3.00e-03 Turkey K 3.26e+04 1.26e+03 Turkey R 3.50e-01 6.00e-03 United Kingdom K 7.98e+04 2.54e+03 United Kingdom R 2.16e-01 1.00e-03 USA K 4.00e+05 1.12e+04 USA R 2.95e-01 2.00e-03 5.1, we observe, for each country, the number of confirmed case with the “K” and the infection rate with the “K”. We notice that the Japan doesn’t figure in this table. In order to assess the goodness-of-fit of the logistic model in the various countries, we plot the residuals of our predictions. Figure 5.1: Figure 14 In this plot 5.1, we observe that the resdiduals increase with the time dimension, which it’s not surprising. 5.2 Fitted parameters and long-term predictions Describe the fitted parameters (i.e., the final size and the infection rates), both on a per-country basis and some aggregate numbers (e.g., total size of the epidemic over all considered countries). Furthermore, study the evolution (say for \\(t\\) from 0 to 50) of the predictions of the number of confirmed cases from your models. Similarly as was discussed in the last sub-section of the exploratory data analysis, the number of confirmed cases per 100,000 habitants is also important to understand how specific countries are managing the spread of the epidemic. Thus, predict the evolution of this number (i.e., by dividing your predictions for confirmed cases by the population size) and discuss. Hints: Format the fitted parameters using broom::tidy(). For the long-term predictions, you can use data = data.frame(t = 0:50) in add_predictions(). Figure 5.2: Figure 15 In this plot, we observe an increase with the time regarding our predicted confirmed case.5.2 But in order to better undersant which curve correspond to which country, we add the country name for each curve. Figure 5.3: Figure 16 Therefore, we notice that the exponentital curve correspond to the USA.5.3 To better evaluate the evolution, we poursuive the same analysis but regarding to the population if each country, in order to better visualize the problematic. Figure 5.4: Figure 17 When we look the number of case proportional to the population 5.4, we notice that the plot isn’t the same as before, and that now the exponential curve corresponf to Luxembrug and Iceland. "],
["references.html", "References", " References "]
]
